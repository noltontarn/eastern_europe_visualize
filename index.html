<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="jquery-3.4.0.js"></script>
    <script src="jquery-csv.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {
        'packages':['geochart', 'controls'],
        // Note: you will need to get a mapsApiKey for your project.
        // See: https://developers.google.com/chart/interactive/docs/basic_load_libs#load-settings
        'mapsApiKey': 'AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY'
      });
      google.charts.setOnLoadCallback(drawRegionsMap);

      function drawRegionsMap() {
        /*var dataAgriculture = google.visualization.arrayToDataTable([
          ['Country', 'Value Added (%GDP)', 'Year'],
          ['Bulgaria', 200, 2003],
          ['Greece', 200, 2004],
          ['Poland', 200, 2003],
          ['Romania', 200, 2013],
          ['Russia', 200, 2004],
        ]);*/

        /*var dataServices = google.visualization.arrayToDataTable([
          ['Country', 'Value Added (%GDP)', 'Year'],
          ['Bulgaria', 300, 2003],
          ['Greece', 300, 2004],
          ['Poland', 300, 2003],
          ['Romania', 300, 2013],
          ['Russia', 300, 2004],
        ]);

        var dataIndustry = google.visualization.arrayToDataTable([
          ['Country', 'Value Added (%GDP)', 'Year'],
          ['Bulgaria', 400, 2003],
          ['Greece', 400, 2004],
          ['Poland', 400, 2003],
          ['Romania', 400, 2013],
          ['Russia', 400, 2004],
        ]);
            */
        var dashboard = new google.visualization.Dashboard(document.getElementById('dashboard_div'));

        var yearSelector = new google.visualization.ControlWrapper({
            controlType: 'CategoryFilter',
            containerId: 'filter_div',
            options: {
                filterColumnLabel: 'Year',
                ui: {
                    allowTyping: false,
                    allowMultiple: false,
                    allowNone: false
                }
            }
        });

        var mapChart = new google.visualization.ChartWrapper({
            chartType: 'GeoChart',
            containerId: 'regions_div',
            options: {
                region: '150',
                colorAxis: {colors: ['#e7711c', '#4374e0']}
            }
        });
        
        dashboard.bind(yearSelector, mapChart);
        //console.log("outfunction " + dataAgriculture.getTableProperties);
        $.get("Agriculture.csv", function(csvString) {
                var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});
                var data = google.visualization.arrayToDataTable(arrayData);
                console.log("infunction " + data);
                dashboard.draw(data);
                document.getElementById("current").innerHTML = "Agriculture";
        });

        document.getElementById('agriculture').addEventListener('click', function () {
            $.get("Agriculture.csv", function(csvString) {
                var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});
                var data = google.visualization.arrayToDataTable(arrayData);
                console.log("infunction " + data);
                dashboard.draw(data);
                document.getElementById("current").innerHTML = "Agriculture";
            });
        }, false);

        document.getElementById('services').addEventListener('click', function () {
            $.get("Services.csv", function(csvString) {
                var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});
                var data = google.visualization.arrayToDataTable(arrayData);
                console.log("infunction " + data);
                dashboard.draw(data);
                document.getElementById("current").innerHTML = "Services";
            });
        }, false);

        document.getElementById('industry').addEventListener('click', function () {
            $.get("Industry.csv", function(csvString) {
                var arrayData = $.csv.toArrays(csvString, {onParseValue: $.csv.hooks.castToScalar});
                var data = google.visualization.arrayToDataTable(arrayData);
                console.log("infunction " + data);
                dashboard.draw(data);
                document.getElementById("current").innerHTML = "Industry";
            });
        }, false);
      }
    </script>
  </head>
  <body>
    <h1>Selected: <span id="current"></span></h1>
    <div id="dashboard_div">
        <div id="filter_div"></div>
        <div id="regions_div" style="width: 900px; height: 500px;"></div>
        <input type="button" id="agriculture" value="Agriculture" />
        <input type="button" id="services" value="Services" />
        <input type="button" id="industry" value="Industry" />
      </div>
  </body>
</html>